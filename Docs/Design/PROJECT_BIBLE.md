# PROJECT\_BIBLE v2.3.0 — ECHO: Legends of the Veil

## (раб. назв. «Грань Миров» / Resonance RPG)

> **Зачем этот документ**
> Это **единая точка входа** для любого человека (разработчик, геймдизайнер, сценарист, продюсер, инвестор).
> Прочитав его, он должен понять:
>
> 1. о чём игра и почему она «затягивает»,
> 2. в чём уникальная идея и чем мы отличаемся,
> 3. как работает геймплей (на уровне системы),
> 4. как это сделано архитектурно (Engine-first + content packs),
> 5. как мы будем расширять игру годами DLC/модулями, не ломая основу.

**Сеттинг (канон):** **славянское тёмное фэнтези** (Slavic Dark Fantasy).

**LOCKED решения:**

- **Resonance шкала:** `-100…+100` (Навь ↔ Явь ↔ Правь)
- **Кооп:** в v2.3.0 **нет**, но архитектура проектируется так, чтобы 2–4 игрока добавить без ломки системы
- **Fate Deck:** механизм в движке, **FateCards загружаются из Campaign Pack**; движок поддерживает сменные RNG-резолверы (Fate/Dice/Token Bag)

**Документы глубже:** Vision 2.0, GDD v3.0, ADD v2.0, ENGINE\_ARCHITECTURE, EVENT\_MODULE\_ARCHITECTURE, Pack Specs, QA.

---

## 1) Elevator pitch (канон)

**Оффлайн сюжетная RPG-кампания с колодостроением, где каждая сыгранная карта сдвигает Резонанс Яви–Нави–Прави и меняет “физику” мира, заставляя игрока выбирать: победить быстро (ценой Нави), правильно (ценой Прави) или по‑человечески (ценой Яви) — и жить с последствиями.**

---

## 2) Что это за опыт для игрока

### 2.1 Почему не отпускает

- **Постоянное напряжение** (как Arkham): каждый ход — риск; судьба управляема, но не покорна.
- **Моральные узлы** (как Witcher): решения не делятся на «хорошо/плохо», а на «какой ценой».
- **Реактивный мир** (как Fallout): мир меняет отношение к тебе и перестраивает события под твой путь.

### 2.2 Как выглядит «один вечер»

- ты выходишь из деревни в лес за пропавшими детьми;
- в бою с духом выбираешь: **убить** (быстро) или **успокоить** (дольше);
- резонанс уходит в Навь → в следующем узле торговец исчезает, но открывается тёмная тропа;
- гадалка даёт заглянуть в Fate Deck → ты планируешь риск на следующий «порог» истории;
- возвращаясь, понимаешь: это уже **другая деревня** и **другая ты** (колода изменилась).

---

## 3) Мир и философия трёх миров

### 3.1 Навь ≠ зло

Навь — мир духов, памяти, предков и цены. Без неё нет жизни.

### 3.2 Правь ≠ добро

Правь — закон, порядок, контракт. Абсолютный порядок = застой.

### 3.3 Явь — человеческая реальность

Дороги, хлеб, дым печей, страх, ответственность. Явь — то, что реально ломается.

**Выбор игрока — не “добро/зло”, а:**

- Порядок (Правь)
- Мистика/цена (Навь)
- Человечность/материя (Явь)

---

## 4) Стержень игры (Core Pillar)

### «Мир — эхо твоих действий. Ты — то, что ты делаешь.»

Эта игра не про «нанесение урона», а про **последствия**:

- мир реагирует на твою стратегию,
- герой меняется через колоду,
- выбор победы в конфликте формирует дальнейшую историю.

---

## 5) Три ключевые механики (то, что делает игру уникальной)

### 5.1 Резонанс Миров (World Resonance)

**Что это:** глобальная шкала `-100…+100`.

**Что её двигает:**

- карты игрока,
- намерения врагов (intent),
- выборы событий,
- ритуалы/пакты.

**Что она меняет:**

- доступность вариантов в событиях,
- эффективность карт (особенно Echo‑карт),
- реакции врагов и локаций,
- отношения NPC/доступ к учителям/пактам.

**Связь с картой/регионами (канон):** сдвиг резонанса влияет на **состояния регионов** (Stable/Borderland/Breach) и на **Якоря**:

- в «глубокой Нави» повышается риск деградации регионов и осквернения якорей;
- в «глубокой Прави» проще стабилизировать/очищать, но часть тёмных решений закрывается;
- Явь — зона “человеческой устойчивости”: проще восстановление/торговля, но меньше сырой силы.

**Почему это тренд:** игрок управляет **законами сцены**, а не только ресурсами.

**Визуализация (для художников/саунд-дизайна):** Резонанс — не только UI‑шкала, это **состояние окружения**.

- При сдвиге в **Навь**: мир темнеет, усиливаются тени/туман, звук становится «глуше», появляются шёпоты/дальние голоса, NPC пугаются/избегают.
- При сдвиге в **Правь**: мир становится «стерильным» и холодным, звуки чище и резче, меньше живых деталей, больше порядка/симметрии; NPC говорят коротко и формально.
- В **Яви**: “человеческая” естественность — тепло, быт, дым, живые звуки.

### 5.2 Единый конфликт (Unified Encounter): Тело + Воля

У противника две шкалы:

- **Body (HP)** — убить/сломать физически
- **Spirit (Resolve/WP)** — изгнать/успокоить/сломить волю

**Два способа победы:**

- **Kill (HP→0):** быстрее/больше трофеев, но резонанс часто уходит в Навь, мир «грубеет»
- **Pacify (Resolve→0):** сложнее/меньше лута, но Правь усиливается, открываются другие ветки

**Переход между стратегиями (тактическая глубина):** игрок может **передумать в процессе** столкновения, но это стоит дороже.

- Начал «убивать», а потом решил «успокоить»? Противник уже ранен/разъярён — чтобы увести бой в Pacify, нужно больше ресурсов/ходов и выше риск.
- И наоборот: попытка договориться, сорвавшаяся в драку, ведёт к более жёстким последствиям (флаги/резонанс/репутация).

**Это решает сразу 3 задачи:**

- «мирный путь» становится частью той же боевой системы;
- каждый бой — моральное решение;
- балансируется контент‑паками без новых механик.

### 5.3 Судьба как колода (Fate Deck) вместо кубиков

**Зачем:** оффлайн + настолочный порт + напряжение = конечная, управляемая случайность.

**Fate Test:** `Stat + FateCard (+ Effort) >= Difficulty`

**Колода живёт и меняется по ходу кампании:**

- **Peek/Reorder:** гадалка показывает N верхних карт и позволяет упорядочить
- **Add Curse (sticky):** проклятие добавляет карту, которая возвращается, пока не снята
- **Add Blessing:** временно усиливает колоду
- **Remove/Cleanse:** ритуалы/Правь очищают колоду

**Fate Deck как прогресс (вместо “классической прокачки”):** развитие героя часто выражается не +1 к стату, а изменением Fate Deck.

- «Level Up» может означать: удалить 1 негативную карту судьбы, добавить полезную карту, или получить доступ к манипуляции (peek/reorder).
- Это удерживает прогрессию в рамках философии: меняется не цифра, а **судьба и способы рисковать**.

**Важно:** механизм FateDeck — часть движка, но **содержимое FateCards загружается из Campaign Pack**, и может различаться между кампаниями.

### 5.4 Глоссарий ключевых боевых систем

- **Fate Deck** — колода карт судьбы, определяющая модификаторы к проверкам и атакам
- **Resonance** — система резонанса между картами, усиливающая эффекты комбинаций
- **EnemyIntent** — система намерений врагов, предсказуемые паттерны атак

---

## 6) Геймплейный цикл (Loop)

### Фаза A — Исследование (Fallout vibe)

- перемещение по графу узлов;
- события зависят от резонанса;
- проверки через Fate Deck;
- последствия фиксируются флагами.

### Фаза B — Столкновение (Arkham vibe)

- враг раскрывает намерение (intent);
- игрок решает: Kill или Pacify;
- карты и резонанс меняют “физику” боя;
- кризисы/микро‑события раунда (позже расширяем).

### Фаза C — Хаб/Лагерь (Witcher vibe)

- NPC реагируют на резонанс/репутацию;
- «учителя» и «места силы» открывают новые карты через микро‑квесты;
- пакты дают силу, но закрывают пути.

---

## 7) Герой и прогресс (как Arkham+Spire)

### 7.1 Статика и динамика

- базовые статы меняются редко;
- прогресс — **колода + предметы + знания**.

### 7.2 Герой как судьба (подготовлено, позже углубим)

- в v2.3.0 герой меняется через колоду/бремя;
- в будущих версиях добавим эволюцию/аспекты (state machine) и «пороки».

---

## 8) Контент‑платформа (DLC модель как у Arkham LCG)

### 8.1 Core Box

- базовая система + базовые сущности;
- стартовая кампания.

### 8.2 Campaign Packs

- сценарии/узлы/локации/события/враги/квесты/тексты;
- FateCards (если RNG=fate\_deck);
- совместимы с любыми персонажами.

### 8.3 Character Packs

- персонажи, стартовые колоды, карты персонажей;
- совместимы с любыми кампаниями.

### 8.4 Tales Packs (Сказания)

- одиночные сценарии/мини‑квесты (мини‑истории/«сказания»), которые можно «встраивать» в кампанию;
- добавляют события/узлы/награды;
- не ломают основной сюжет;
- имеют собственные условия включения (флаги/резонанс/акт).

### 8.5 Balance Packs

- только числа/веса/лимиты;
- не меняют формулы.

### 8.6 Rules Extensions (редко)

- добавляют capability (например другой RNG resolver);
- обязаны быть обратносуместимыми.

---

## 9) Архитектура (как это сделано простыми словами)

### 9.1 Engine‑first (критически важно)

UI **никогда** не меняет state напрямую. Единственный способ изменить игру — отправить действие в движок:

- `engine.performAction(...)`

Это гарантирует:

- воспроизводимость (seed → outcome),
- строгую валидацию контента (packs),
- отсутствие «скрытых правил» в UI.

Это позволяет выпускать контент‑паки без правок кода и гарантировать качество тестами/валидатором.

### 9.2 Event Pipeline

- Inline события: narrative/choice/exploration
- Mini‑Game события: encounter/combat/fate‑test

Результат всегда возвращается как diff и применяется движком.

### 9.3 Content Packs

Контент добавляется паками (offline). Пак валидируется перед запуском.

### 9.4 RNG Resolver Strategy (LOCKED)

Движок поддерживает сменные RNG‑резолверы:

- Fate Deck
- Dice
- Token Bag

Campaign pack выбирает resolver.

---

## 10) Потенциал и почему это можно развивать годами

- новые кампании = новые истории без переписывания системы;
- новые персонажи меняют игру без ребаланса формул;
- моддинг возможен через паки при строгой валидации;
- порт в настолку реалистичен: резонанс + fate deck + dual‑track — столовые механики.

### 10.1 Дополнительные системы

- **Player Progression** — Бестиарий (коллекция побеждённых врагов), Достижения, Профиль игрока
- **PackEditor** — macOS-приложение для визуального создания и редактирования контент-паков

---

## 11) Scope v2.3.0 (чтобы не утонуть)

> **Покрытие:** 606+ SPM tests (движок + приложение), 0 failures.

### v2.3.0 MUST

- Resonance влияет на события и бой;
- Fate Deck для проверок;
- dual‑track encounter хотя бы для части врагов;
- intents у врагов (минимум 1 намерение/ход);
- одна кампания (3 сценария) + несколько персонажей;
- **Система аналитики выборов (оффлайн):** логировать ключевые решения/сдвиги резонанса/пути победы (Kill vs Pacify) в локальный журнал. В v1.0 достаточно локального хранения + экспорт по желанию (для балансировки будущих паков).
- **Надёжные сохранения (Save/Load) на каждом ходе:** автосейв после `engine.performAction(...)` и безопасное восстановление состояния кампании (критично для оффлайн-сессий 3–4 часа).
  - Требование: ни одно действие не считается применённым, пока не записан валидный сейв (или не сделан безопасный rollback).

### v2.3.0 NOT NOW

- кооператив 2–4 (архитектурная готовность);
- эволюция героя как state machine;
- режиссёр AI.

---

## 12) Санитарные тесты концепта (если нарушены — концепт потерян)

- Резонанс не влияет на контент/бой.
- Все конфликты решаются только по HP.
- Fate Deck не даёт планируемого риска.

---

## 13) Примеры (коротко)

**Резонанс:**
Ты часто взываешь к Нави — в деревне начинают гаснуть огни, торговцы отказываются говорить, люди прячутся. Но на кладбище призраки теперь **дают квесты**, а не нападают, и открывается тёмная тропа через лес.

**Dual‑track:**
Разбойник: можно убить (быстро) или сломить волю (долго). Исход меняет резонанс и будущие ветки.

