# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ Content Pack

> **–í–µ—Ä—Å–∏—è:** 2.1
> **–û–±–Ω–æ–≤–ª–µ–Ω–æ:** –§–µ–≤—Ä–∞–ª—å 2026

–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é –∫–æ–Ω—Ç–µ–Ω—Ç-–ø–∞–∫–æ–≤ –¥–ª—è –∏–≥—Ä—ã "–°—É–º—Ä–∞—á–Ω—ã–µ –ü—Ä–µ–¥–µ–ª—ã".

---

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–±–∑–æ—Ä](#–æ–±–∑–æ—Ä)
2. [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–∫–∞](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø–∞–∫–∞)
3. [–ü–µ—Ä—Å–æ–Ω–∞–∂–∏ (heroes.json)](#–ø–µ—Ä—Å–æ–Ω–∞–∂–∏)
4. [–ö–∞—Ä—Ç—ã (cards.json)](#–∫–∞—Ä—Ç—ã)
5. [–†–µ–≥–∏–æ–Ω—ã –∏ —Å–æ–±—ã—Ç–∏—è](#—Ä–µ–≥–∏–æ–Ω—ã-–∏-—Å–æ–±—ã—Ç–∏—è)
6. [–õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è](#–ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è)
7. [–ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞](#–∑–∞–≥—Ä—É–∑–∫–∞-–∫–æ–Ω—Ç–µ–Ω—Ç–∞)
8. [–í–∞–ª–∏–¥–∞—Ü–∏—è](#–≤–∞–ª–∏–¥–∞—Ü–∏—è)
9. [Hot-Reload –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏](#hot-reload-–¥–ª—è-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

---

## –û–±–∑–æ—Ä

### –ß—Ç–æ —Ç–∞–∫–æ–µ Content Pack?

Content Pack ‚Äî —ç—Ç–æ –Ω–∞–±–æ—Ä JSON-—Ñ–∞–π–ª–æ–≤ —Å –∏–≥—Ä–æ–≤—ã–º –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º:
- **–ü–µ—Ä—Å–æ–Ω–∞–∂–∏** ‚Äî –≥–µ—Ä–æ–∏ —Å–æ —Å—Ç–∞—Ç–∞–º–∏, —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—è–º–∏ –∏ —Å—Ç–∞—Ä—Ç–æ–≤—ã–º–∏ –∫–æ–ª–æ–¥–∞–º–∏
- **–ö–∞—Ä—Ç—ã** ‚Äî –∫–∞—Ä—Ç—ã –¥–ª—è –∫–æ–ª–æ–¥ –∏ –º–∞–≥–∞–∑–∏–Ω–∞
- **–†–µ–≥–∏–æ–Ω—ã** ‚Äî –ª–æ–∫–∞—Ü–∏–∏ –Ω–∞ –∫–∞—Ä—Ç–µ –º–∏—Ä–∞
- **–°–æ–±—ã—Ç–∏—è** ‚Äî —Å–ª—É—á–∞–π–Ω—ã–µ –∏ —Å—é–∂–µ—Ç–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
- **–ö–≤–µ—Å—Ç—ã** ‚Äî —Ü–µ–ª–∏ –∏ –∑–∞–¥–∞–Ω–∏—è
- **–Ø–∫–æ—Ä—è** ‚Äî —Ç–æ—á–∫–∏ —Å–∏–ª—ã –≤ —Ä–µ–≥–∏–æ–Ω–∞—Ö

### –ü—Ä–∏–Ω—Ü–∏–ø—ã

1. **Data-Driven** ‚Äî –≤–µ—Å—å –∫–æ–Ω—Ç–µ–Ω—Ç –≤ JSON, –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞
2. **–õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è** ‚Äî –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —è–∑—ã–∫–æ–≤
3. **–í–∞–ª–∏–¥–∞—Ü–∏—è** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Å—ã–ª–æ–∫ –∏ –¥–∞–Ω–Ω—ã—Ö
4. **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å** ‚Äî –º–æ–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–∞—Ç—å/–æ—Ç–∫–ª—é—á–∞—Ç—å –ø–∞–∫–∏

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–∫–∞

### –¢–µ–∫—É—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
Resources/Content/           # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç (–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤ –±–∞–Ω–¥–ª)
‚îú‚îÄ‚îÄ heroes.json             # –ü–µ—Ä—Å–æ–Ω–∞–∂–∏
‚îú‚îÄ‚îÄ regions.json            # –†–µ–≥–∏–æ–Ω—ã
‚îú‚îÄ‚îÄ anchors.json            # –Ø–∫–æ—Ä—è
‚îú‚îÄ‚îÄ quests.json             # –ö–≤–µ—Å—Ç—ã
‚îú‚îÄ‚îÄ challenges.json         # –ò—Å–ø—ã—Ç–∞–Ω–∏—è
‚îî‚îÄ‚îÄ events/                 # –ü—É–ª—ã —Å–æ–±—ã—Ç–∏–π
    ‚îú‚îÄ‚îÄ pool_common.json
    ‚îú‚îÄ‚îÄ pool_village.json
    ‚îú‚îÄ‚îÄ pool_forest.json
    ‚îî‚îÄ‚îÄ ...

ContentPacks/TwilightMarches/   # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–∫
‚îú‚îÄ‚îÄ manifest.json              # –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –ø–∞–∫–∞
‚îú‚îÄ‚îÄ Characters/
‚îÇ   ‚îî‚îÄ‚îÄ heroes.json            # –î–æ–ø. –ø–µ—Ä—Å–æ–Ω–∞–∂–∏
‚îú‚îÄ‚îÄ Cards/
‚îÇ   ‚îî‚îÄ‚îÄ cards.json             # –ö–∞—Ä—Ç—ã
‚îú‚îÄ‚îÄ Balance/
‚îÇ   ‚îî‚îÄ‚îÄ balance.json           # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–∞–ª–∞–Ω—Å–∞
‚îî‚îÄ‚îÄ Localization/
    ‚îú‚îÄ‚îÄ en.json
    ‚îî‚îÄ‚îÄ ru.json
```

---

## –ü–µ—Ä—Å–æ–Ω–∞–∂–∏

–ü–µ—Ä—Å–æ–Ω–∞–∂–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ `heroes.json` —á–µ—Ä–µ–∑ `HeroRegistry`.

### –§–æ—Ä–º–∞—Ç heroes.json

```json
[
  {
    "id": "warrior_ragnar",
    "name": "Ragnar",
    "name_ru": "–†–∞–≥–Ω–∞—Ä",
    "hero_class": "warrior",
    "description": "Former commander of the royal guard.",
    "description_ru": "–ë—ã–≤—à–∏–π –∫–æ–º–∞–Ω–¥–∏—Ä –∫–æ—Ä–æ–ª–µ–≤—Å–∫–æ–π –≥–≤–∞—Ä–¥–∏–∏. –ï–≥–æ —è—Ä–æ—Å—Ç—å –≤ –±–æ—é –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞.",
    "icon": "figure.fencing",
    "base_stats": {
      "health": 12,
      "max_health": 12,
      "strength": 7,
      "dexterity": 3,
      "constitution": 5,
      "intelligence": 1,
      "wisdom": 2,
      "charisma": 2,
      "faith": 2,
      "max_faith": 8,
      "starting_balance": 50
    },
    "ability_id": "warrior_rage",
    "starting_deck_card_ids": ["strike_basic", "strike_basic", "defend_basic", "rage_strike"],
    "availability": "always_available"
  }
]
```

### –ü–æ–ª—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| `id` | string | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä |
| `name` | string | –ò–º—è –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º |
| `name_ru` | string | –ò–º—è –Ω–∞ —Ä—É—Å—Å–∫–æ–º |
| `description` | string | –û–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º |
| `description_ru` | string | –û–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ —Ä—É—Å—Å–∫–æ–º |
| `icon` | string | SF Symbol –¥–ª—è –∏–∫–æ–Ω–∫–∏ |
| `base_stats` | object | –ë–∞–∑–æ–≤—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ |
| `ability_id` | string | ID —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –∏–∑ `HeroAbility` |
| `starting_deck_card_ids` | [string] | ID –∫–∞—Ä—Ç —Å—Ç–∞—Ä—Ç–æ–≤–æ–π –∫–æ–ª–æ–¥—ã |
| `availability` | string | –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å: `always_available`, `dlc:pack_id`, `requires_unlock:condition` |

### –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ (base_stats)

| –ü–æ–ª–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| `health` | –¢–µ–∫—É—â–µ–µ –∑–¥–æ—Ä–æ–≤—å–µ |
| `max_health` | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ |
| `strength` | –°–∏–ª–∞ (—É—Ä–æ–Ω –≤ –±–æ—é) |
| `dexterity` | –õ–æ–≤–∫–æ—Å—Ç—å |
| `constitution` | –¢–µ–ª–æ—Å–ª–æ–∂–µ–Ω–∏–µ (–∑–∞—â–∏—Ç–∞) |
| `intelligence` | –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç |
| `wisdom` | –ú—É–¥—Ä–æ—Å—Ç—å |
| `charisma` | –•–∞—Ä–∏–∑–º–∞ |
| `faith` | –¢–µ–∫—É—â–∞—è –≤–µ—Ä–∞ |
| `max_faith` | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≤–µ—Ä–∞ |
| `starting_affinity` | –ù–∞—á–∞–ª—å–Ω–∞—è —Å–∫–ª–æ–Ω–Ω–æ—Å—Ç—å –≥–µ—Ä–æ—è PlayerAffinity (-100..+100) |

### –°–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

–°–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤ `HeroAbility.swift`. –î–æ—Å—Ç—É–ø–Ω—ã–µ ID:

| ability_id | –ù–∞–∑–≤–∞–Ω–∏–µ | –≠—Ñ—Ñ–µ–∫—Ç |
|------------|----------|--------|
| `warrior_rage` | –Ø—Ä–æ—Å—Ç—å | +2 —É—Ä–æ–Ω –ø—Ä–∏ HP < 50% |
| `mage_meditation` | –ú–µ–¥–∏—Ç–∞—Ü–∏—è | +1 –≤–µ—Ä–∞ –≤ –∫–æ–Ω—Ü–µ —Ö–æ–¥–∞ |
| `ranger_tracking` | –í—ã—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ | +1 –∫—É–±–∏–∫ –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –∞—Ç–∞–∫–µ |
| `priest_blessing` | –ë–ª–∞–≥–æ—Å–ª–æ–≤–µ–Ω–∏–µ | -1 —É—Ä–æ–Ω –æ—Ç —Ç—ë–º–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ |
| `shadow_ambush` | –ó–∞—Å–∞–¥–∞ | +3 —É—Ä–æ–Ω–∞ –ø–æ —Ü–µ–ª—è–º —Å –ø–æ–ª–Ω—ã–º HP |

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞

1. –î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å –≤ `heroes.json`
2. –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –Ω–æ–≤–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –≤ `HeroAbility.forAbilityId()`
3. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –∫–∞—Ä—Ç—ã –∏–∑ `starting_deck_card_ids` —Å—É—â–µ—Å—Ç–≤—É—é—Ç –≤ `CardRegistry`

---

## –ö–∞—Ä—Ç—ã

### –§–æ—Ä–º–∞—Ç cards.json

```json
[
  {
    "id": "strike_basic",
    "name": "Strike",
    "name_ru": "–£–¥–∞—Ä",
    "card_type": "attack",
    "rarity": "common",
    "description": "Deal 3 damage to enemy",
    "description_ru": "–ù–∞–Ω–µ—Å—Ç–∏ 3 —É—Ä–æ–Ω–∞ –≤—Ä–∞–≥—É",
    "icon": "bolt.fill",
    "expansion_set": "baseSet",
    "ownership": "universal",
    "abilities": [
      {
        "type": "damage",
        "value": 3
      }
    ],
    "faith_cost": 0,
    "balance": "neutral",
    "power": 3,
    "cost": 1,
    "exhaust": false
  }
]
```

### –ù–æ–≤—ã–µ –ø–æ–ª—è –∫–∞—Ä—Ç (v2.1)

| –ü–æ–ª–µ | –¢–∏–ø | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|--------------|----------|
| `cost` | int? | `1` | –°—Ç–æ–∏–º–æ—Å—Ç—å —ç–Ω–µ—Ä–≥–∏–∏ –∑–∞ —Ä–æ–∑—ã–≥—Ä—ã—à –∫–∞—Ä—Ç—ã. `null` = 1 |
| `exhaust` | bool | `false` | –ï—Å–ª–∏ `true`, –∫–∞—Ä—Ç–∞ —É–¥–∞–ª—è–µ—Ç—Å—è –∏–∑ –∫–æ–ª–æ–¥—ã –ø–æ—Å–ª–µ —Ä–æ–∑—ã–≥—Ä—ã—à–∞ (–≤ exhaustPile) |

**–ü—Ä–∏–º–µ—Ä –∫–∞—Ä—Ç—ã —Å exhaust:**
```json
{
  "id": "poison_blade",
  "name": "Poison Blade",
  "card_type": "attack",
  "rarity": "uncommon",
  "abilities": [{"type": "damage", "value": 5}, {"type": "applyCurse", "value": 2}],
  "cost": 2,
  "exhaust": true
}
```

### –¢–∏–ø—ã –∫–∞—Ä—Ç (card_type)

- `attack` ‚Äî –∞—Ç–∞–∫—É—é—â–∏–µ –∫–∞—Ä—Ç—ã
- `defense` ‚Äî –∑–∞—â–∏—Ç–Ω—ã–µ –∫–∞—Ä—Ç—ã
- `resource` ‚Äî —Ä–µ—Å—É—Ä—Å–Ω—ã–µ –∫–∞—Ä—Ç—ã
- `special` ‚Äî –æ—Å–æ–±—ã–µ –∫–∞—Ä—Ç—ã
- `curse` ‚Äî –ø—Ä–æ–∫–ª—è—Ç–∏—è

### –†–µ–¥–∫–æ—Å—Ç—å (rarity)

- `common` ‚Äî –æ–±—ã—á–Ω–∞—è
- `uncommon` ‚Äî –Ω–µ–æ–±—ã—á–Ω–∞—è
- `rare` ‚Äî —Ä–µ–¥–∫–∞—è
- `legendary` ‚Äî –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è

### –í–ª–∞–¥–µ–Ω–∏–µ (ownership)

- `universal` ‚Äî –¥–æ—Å—Ç—É–ø–Ω–∞ –≤—Å–µ–º
- `starter` ‚Äî —Ç–æ–ª—å–∫–æ –≤ —Å—Ç–∞—Ä—Ç–æ–≤—ã—Ö –∫–æ–ª–æ–¥–∞—Ö
- `market` ‚Äî —Ç–æ–ª—å–∫–æ –≤ –º–∞–≥–∞–∑–∏–Ω–µ

---

## –†–µ–≥–∏–æ–Ω—ã –∏ —Å–æ–±—ã—Ç–∏—è

### regions.json

```json
{
  "regions": [
    {
      "id": "village",
      "title_key": "region_village",
      "description_key": "region_village_desc",
      "neighbor_ids": ["forest", "road"],
      "initial_state": "stable",
      "initially_discovered": true,
      "anchor_id": "village_chapel",
      "event_pool_ids": ["pool_village", "pool_common"]
    }
  ]
}
```

### events/pool_*.json

```json
{
  "events": [
    {
      "id": "village_merchant",
      "title_key": "event_merchant_title",
      "description_key": "event_merchant_desc",
      "weight": 10,
      "is_one_time": false,
      "availability": {
        "min_pressure": 0,
        "max_pressure": 50
      },
      "choices": [
        {
          "id": "buy",
          "label_key": "choice_buy",
          "consequences": {
            "faith_cost": 3,
            "draw_cards": 1
          }
        },
        {
          "id": "leave",
          "label_key": "choice_leave",
          "consequences": {}
        }
      ]
    }
  ]
}
```

---

## –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è

### –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è (–≤ JSON)

```json
{
  "name": "Ragnar",
  "name_ru": "–†–∞–≥–Ω–∞—Ä",
  "description": "English description",
  "description_ru": "–û–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ —Ä—É—Å—Å–∫–æ–º"
}
```

### –§–∞–π–ª—ã –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏

`Localization/ru.json`:
```json
{
  "region_village": "–î–µ—Ä–µ–≤–Ω—è",
  "region_village_desc": "–ù–µ–±–æ–ª—å—à–∞—è –¥–µ—Ä–µ–≤–Ω—è –Ω–∞ –≥—Ä–∞–Ω–∏—Ü–µ",
  "event_merchant_title": "–¢–æ—Ä–≥–æ–≤–µ—Ü",
  "choice_buy": "–ö—É–ø–∏—Ç—å"
}
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞

```swift
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è —è–∑—ã–∫ —Å–∏—Å—Ç–µ–º—ã
let contentRegistry = ContentRegistry()
try contentRegistry.loadPacks(from: packURLs)

let localizationManager = LocalizationManager()
let hero = contentRegistry.heroRegistry.hero(id: "warrior_ragnar")
print(hero?.name.resolve(using: localizationManager) ?? "")
print(hero?.description.resolve(using: localizationManager) ?? "")
```

---

## –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞

### HeroRegistry

```swift
let contentRegistry = ContentRegistry()
try contentRegistry.loadPacks(from: packURLs)

// –ü–æ–ª—É—á–∏—Ç—å –≥–µ—Ä–æ—è –ø–æ ID
let hero = contentRegistry.heroRegistry.hero(id: "warrior_ragnar")

// –í—Å–µ –≥–µ—Ä–æ–∏
let allHeroes = contentRegistry.heroRegistry.allHeroes

// –î–æ—Å—Ç—É–ø–Ω—ã–µ –≥–µ—Ä–æ–∏ (—Å —É—á—ë—Ç–æ–º DLC/—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–æ–∫)
let available = contentRegistry.heroRegistry.availableHeroes()
```

### CardRegistry

```swift
let contentRegistry = ContentRegistry()
try contentRegistry.loadPacks(from: packURLs)

// –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ä—Ç–æ–≤—É—é –∫–æ–ª–æ–¥—É (IDs) –¥–ª—è –≥–µ—Ä–æ—è
let hero = contentRegistry.heroRegistry.hero(id: "warrior_ragnar")
let deckCardIds = hero?.startingDeckCardIDs ?? []

// –ü–æ–ª—É—á–∏—Ç—å –∫–∞—Ä—Ç—É –ø–æ ID
let card = contentRegistry.getCard(id: "strike_basic")
```

### –°–æ–∑–¥–∞–Ω–∏–µ –∏–≥—Ä–æ–∫–∞

```swift
let contentRegistry = ContentRegistry()
try contentRegistry.loadPacks(from: packURLs)

let heroId = "warrior_ragnar"
let hero = contentRegistry.heroRegistry.hero(id: heroId)
let startingDeckCardIds = hero?.startingDeckCardIDs ?? []
```

---

## –í–∞–ª–∏–¥–∞—Ü–∏—è

### PackValidator

```swift
let validator = PackValidator(packURL: packURL)
let summary = validator.validate()

if !summary.isValid {
    for error in summary.errors {
        print("–û—à–∏–±–∫–∞: \(error)")
    }
}
```

### –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏

| –û—à–∏–±–∫–∞ | –ü—Ä–∏—á–∏–Ω–∞ | –†–µ—à–µ–Ω–∏–µ |
|--------|---------|---------|
| Unknown ability_id | –°–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ | –î–æ–±–∞–≤–∏—Ç—å –≤ `HeroAbility.forAbilityId()` |
| Card not found | –ö–∞—Ä—Ç–∞ –∏–∑ —Å—Ç–∞—Ä—Ç–æ–≤–æ–π –∫–æ–ª–æ–¥—ã –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å ID –∫–∞—Ä—Ç—ã |
| Missing region | –°–æ—Å–µ–¥ —Ä–µ–≥–∏–æ–Ω–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `neighbor_ids` |
| Negative energy cost | `cost` < 0 —É –∫–∞—Ä—Ç—ã | –£–∫–∞–∑–∞—Ç—å `cost` >= 0 –∏–ª–∏ —É–±—Ä–∞—Ç—å –ø–æ–ª–µ |
| Exhaust without effect | –ö–∞—Ä—Ç–∞ —Å `exhaust: true` –±–µ–∑ abilities –∏ power | –î–æ–±–∞–≤–∏—Ç—å —ç—Ñ—Ñ–µ–∫—Ç –∏–ª–∏ —É–±—Ä–∞—Ç—å exhaust |
| Enemy empty name | –£ –≤—Ä–∞–≥–∞ –ø—É—Å—Ç–æ–µ –∏–º—è | –ó–∞–ø–æ–ª–Ω–∏—Ç—å `name` |
| Enemy non-positive health | `health` <= 0 | –£–∫–∞–∑–∞—Ç—å health > 0 |
| Enemy empty pattern | –ú–∞—Å—Å–∏–≤ `pattern` –ø—É—Å—Ç–æ–π | –î–æ–±–∞–≤–∏—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —à–∞–≥ –∏–ª–∏ —É–±—Ä–∞—Ç—å pattern |

---

## –ü—Ä–∏–º–µ—Ä: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞

### 1. –î–æ–±–∞–≤–∏—Ç—å –≤ heroes.json

```json
{
  "id": "necromancer_dark",
  "name": "Mortis",
  "name_ru": "–ú–æ—Ä—Ç–∏—Å",
  "hero_class": "shadow",
  "description": "Master of the undead",
  "description_ru": "–ü–æ–≤–µ–ª–∏—Ç–µ–ª—å –Ω–µ–∂–∏—Ç–∏",
  "icon": "moon.stars.fill",
  "base_stats": {
    "health": 8,
    "max_health": 8,
    "strength": 3,
    "dexterity": 2,
    "constitution": 2,
    "intelligence": 6,
    "wisdom": 4,
    "charisma": 1,
    "faith": 4,
    "max_faith": 12,
    "starting_balance": 20
  },
  "ability_id": "shadow_ambush",
  "starting_deck_card_ids": ["dark_bolt", "dark_bolt", "soul_drain", "raise_dead"],
  "availability": "always_available"
}
```

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∫–∞—Ä—Ç—ã —Å—É—â–µ—Å—Ç–≤—É—é—Ç

–£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ `dark_bolt`, `soul_drain`, `raise_dead` –µ—Å—Ç—å –≤ CardRegistry.

### 3. –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

–ü–µ—Ä—Å–æ–Ω–∞–∂ –ø–æ—è–≤–∏—Ç—Å—è –≤ —Å–ø–∏—Å–∫–µ –≤—ã–±–æ—Ä–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

---

## Pack Format

### –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (v2.x) ‚úÖ

**Authoring Format:** JSON
**Distribution/Runtime Format:** Binary `.pack`

–ö–æ–Ω—Ç–µ–Ω—Ç —Å–æ–∑–¥–∞—ë—Ç—Å—è –≤ JSON, –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –≤ binary .pack —á–µ—Ä–µ–∑ `pack-compiler`, –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è runtime –Ω–∞–ø—Ä—è–º—É—é –∏–∑ .pack —Ñ–∞–π–ª–æ–≤.

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
Authoring Flow:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ JSON Files  ‚îÇ ‚îÄ‚îÄ‚ñ∂ ‚îÇ Pack Compiler‚îÇ ‚îÄ‚îÄ‚ñ∂ ‚îÇ .pack File  ‚îÇ
‚îÇ (editable)  ‚îÇ     ‚îÇ (packc)      ‚îÇ     ‚îÇ (optimized) ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

Runtime Flow:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ .pack File  ‚îÇ ‚îÄ‚îÄ‚ñ∂ ‚îÇ PackLoader   ‚îÇ ‚îÄ‚îÄ‚ñ∂ ‚îÇ Game Memory ‚îÇ
‚îÇ (binary)    ‚îÇ     ‚îÇ (fast)       ‚îÇ     ‚îÇ             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Binary Pack

| –ê—Å–ø–µ–∫—Ç | JSON | Binary .pack |
|--------|------|--------------|
| –†–∞–∑–º–µ—Ä | ~100KB | ~30KB (gzip) |
| –ü–∞—Ä—Å–∏–Ω–≥ | ~50ms | ~5ms |
| –í–∞–ª–∏–¥–∞—Ü–∏—è | Runtime | Compile-time |
| –ó–∞—â–∏—Ç–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ | –ù–µ—Ç | –î–∞ (–æ–±—Ñ—É—Å–∫–∞—Ü–∏—è) |
| –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ | Manual | Built-in |

### Pack Compiler CLI

```bash
cd Packages/TwilightEngine

# –ö–æ–º–ø–∏–ª—è—Ü–∏—è –ø–∞–∫–∞
swift run pack-compiler compile ./path/to/MyPack ./output/MyPack.pack

# –í–∞–ª–∏–¥–∞—Ü–∏—è –±–µ–∑ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
swift run pack-compiler validate ./path/to/MyPack

# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–∞–∫–µ
swift run pack-compiler info ./MyPack.pack
```

### Binary Pack Structure

```
.pack file format:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Header (magic, version, flags) ‚îÇ  16 bytes
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Manifest (compressed)          ‚îÇ  variable
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Content Table (offsets)        ‚îÇ  variable
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Content Blocks (compressed)    ‚îÇ  variable
‚îÇ   - Heroes                     ‚îÇ
‚îÇ   - Cards                      ‚îÇ
‚îÇ   - Events                     ‚îÇ
‚îÇ   - Regions                    ‚îÇ
‚îÇ   - Localization               ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Checksum (SHA256)              ‚îÇ  32 bytes
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Roadmap

| –í–µ—Ä—Å–∏—è | –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|--------|----------|
| v1.0 | ‚úÖ Done | JSON loading, validation |
| v1.1 | ‚úÖ Done | Pack composition, caching |
| v1.2 | ‚úÖ Done | Season/campaign organization |
| v2.0 | ‚úÖ Done | Binary .pack format, Pack Compiler CLI |
| v2.1 | ‚úÖ Done | Binary runtime loading, Hot-Reload |
| v2.2 | ‚úÖ Done | Content Manager UI |
| v3.0 | ‚úÖ Done | Runtime rejects raw JSON (gate test) |

### Acceptance Criteria

**v2.0 ‚Äî Binary Pack Format** ‚úÖ
- [x] `pack-compiler compile` —Å–æ–∑–¥–∞—ë—Ç –≤–∞–ª–∏–¥–Ω—ã–π .pack —Ñ–∞–π–ª
- [x] Binary runtime loading —Ä–∞–±–æ—Ç–∞–µ—Ç (`ContentRegistry.loadPack`)
- [x] `.pack` —Ñ–∞–π–ª—ã —Å–æ–∑–¥–∞–Ω—ã –¥–ª—è CoreHeroes –∏ TwilightMarchesActI
- [x] –¢–µ—Å—Ç—ã `ContentRegistryTests` –ø—Ä–æ–≤–µ—Ä—è—é—Ç –∑–∞–≥—Ä—É–∑–∫—É .pack —Ñ–∞–π–ª–æ–≤

**v2.1 ‚Äî Hot-Reload** ‚úÖ
- [x] `ContentManager` —Å safe reload –∏ rollback
- [x] –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π
- [x] `ContentManagerTests` ‚Äî 27 —Ç–µ—Å—Ç–æ–≤

**v3.0 ‚Äî Production-Only Binary** ‚úÖ
- [x] `testRuntimeRejectsRawJSON()` ‚Äî gate test –≤ AuditGateTests
- [x] `ContentRegistry.loadPack()` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–æ–ª—å–∫–æ .pack —Ñ–∞–π–ª—ã
- [x] JSON –∑–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–ª—å–∫–æ –≤ PackCompiler/PackLoader (compile-time)

---

## Hot-Reload –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –û–±–∑–æ—Ä

Hot-Reload –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç –≤ —Ä–∞–±–æ—Ç–∞—é—â–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É—Å–∫–æ—Ä—è–µ—Ç –∏—Ç–µ—Ä–∞—Ü–∏—é –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∏ –æ—Ç–ª–∞–¥–∫–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞.

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ ContentManager  ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ ContentManagerVM ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇContentManagerView ‚îÇ
‚îÇ   (Engine)      ‚îÇ     ‚îÇ (ObservableObject)‚îÇ     ‚îÇ    (SwiftUI)      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ ContentRegistry ‚îÇ
‚îÇ   (Singleton)   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ü—Ä–∏–Ω—Ü–∏–ø—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

1. **Validate First, Load Second** ‚Äî –Ω–æ–≤—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –î–û –≤—ã–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ä–æ–≥–æ
2. **Atomic Replacement** ‚Äî —Å—Ç–∞—Ä—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–∫–∞ –Ω–æ–≤—ã–π –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é
3. **Rollback on Failure** ‚Äî –ø—Ä–∏ –æ—à–∏–±–∫–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç–∫–∞—Ç –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é
4. **Production Safety** ‚Äî –±–∏—Ç—ã–µ –ø–∞–∫–∏ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –≥—Ä—É–∑—è—Ç—Å—è, –æ—à–∏–±–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –Ω–æ –Ω–µ –∫—Ä–∞—à–∞—Ç

### Workflow —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞

#### 1. –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ JSON

–†–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ JSON —Ñ–∞–π–ª—ã –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –≤–∞—à–µ–≥–æ –ø–∞–∫–∞:

```
Packages/StoryPacks/Season1/TwilightMarchesActI/
‚îî‚îÄ‚îÄ Sources/TwilightMarchesActIContent/Resources/TwilightMarchesActI/
    ‚îú‚îÄ‚îÄ manifest.json
    ‚îú‚îÄ‚îÄ Campaign/
    ‚îÇ   ‚îú‚îÄ‚îÄ regions.json
    ‚îÇ   ‚îú‚îÄ‚îÄ events.json
    ‚îÇ   ‚îî‚îÄ‚îÄ quests.json
    ‚îú‚îÄ‚îÄ Characters/
    ‚îÇ   ‚îî‚îÄ‚îÄ heroes.json
    ‚îî‚îÄ‚îÄ Cards/
        ‚îî‚îÄ‚îÄ cards.json
```

#### 2. –ö–æ–º–ø–∏–ª—è—Ü–∏—è –ø–∞–∫–∞

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ pack-compiler –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è .pack —Ñ–∞–π–ª–∞:

```bash
cd Packages/TwilightEngine

# –ö–æ–º–ø–∏–ª—è—Ü–∏—è –ø–∞–∫–∞ –≤ Documents (–¥–ª—è hot-reload)
swift run pack-compiler compile \
    ../StoryPacks/Season1/TwilightMarchesActI/Sources/TwilightMarchesActIContent/Resources/TwilightMarchesActI \
    ~/Library/Developer/CoreSimulator/Devices/YOUR_DEVICE_ID/data/Containers/Data/Application/YOUR_APP_ID/Documents/Packs/TwilightMarchesActI.pack
```

> **Tip:** –î–ª—è iOS Simulator –ø—É—Ç—å –∫ Documents –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ —á–µ—Ä–µ–∑ `xcrun simctl get_app_container booted BUNDLE_ID data`

#### 3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Content Manager

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ DEBUG —Ä–µ–∂–∏–º–µ
2. –ù–∞ –≥–ª–∞–≤–Ω–æ–º —ç–∫—Ä–∞–Ω–µ –Ω–∞–∂–º–∏—Ç–µ –∏–∫–æ–Ω–∫—É **üì¶** (Content Manager)
3. –ù–∞–π–¥–∏—Ç–µ –≤–∞—à –ø–∞–∫ –≤ —Å–µ–∫—Ü–∏–∏ **External Packs**
4. –ù–∞–∂–º–∏—Ç–µ **Validate** –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
5. –ù–∞–∂–º–∏—Ç–µ **Reload** –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏

### –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤

| –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ | –ü—É—Ç—å –∫ Documents/Packs/ |
|-----------|-------------------------|
| iOS Simulator | `~/Library/Developer/CoreSimulator/Devices/{DEVICE_ID}/data/Containers/Data/Application/{APP_ID}/Documents/Packs/` |
| iOS Device | –ß–µ—Ä–µ–∑ Files app ‚Üí CardSampleGame ‚Üí Packs/ |
| macOS | `~/Documents/CardSampleGame/Packs/` |

### –°—Ç–∞—Ç—É—Å—ã –ø–∞–∫–æ–≤

| –°—Ç–∞—Ç—É—Å | –ò–∫–æ–Ω–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|--------|----------|
| Discovered | ‚óã | –ù–∞–π–¥–µ–Ω –Ω–∞ –¥–∏—Å–∫–µ, –Ω–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω |
| Validating | ‚ü≥ | –ò–¥—ë—Ç –ø—Ä–æ–≤–µ—Ä–∫–∞ |
| Validated ‚úì | ‚úì | –ü—Ä–æ–≤–µ—Ä–µ–Ω, –æ—à–∏–±–æ–∫ –Ω–µ—Ç |
| Validated ‚ö†Ô∏è | ‚ö†Ô∏è | –ü—Ä–æ–≤–µ—Ä–µ–Ω, –µ—Å—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è |
| Validated ‚úó | ‚úó | –ü—Ä–æ–≤–µ—Ä–µ–Ω, –µ—Å—Ç—å –æ—à–∏–±–∫–∏ |
| Loading | ‚ü≥ | –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è |
| Loaded | ‚óè | –£—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω |
| Failed | ‚úó | –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ |

### API –¥–ª—è Hot-Reload

#### ContentManager (Engine)

```swift
let registry = ContentRegistry()
let contentManager = ContentManager(registry: registry)

// –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø–∞–∫–æ–≤
let packs = contentManager.discoverPacks(bundledURLs: bundledURLs)

// –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞–∫–∞
let summary = await contentManager.validatePack(packId)

// –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å –æ—Ç–∫–∞—Ç–æ–º –ø—Ä–∏ –æ—à–∏–±–∫–µ
let result = await contentManager.safeReloadPack(packId)
switch result {
case .success(let loadedPack):
    print("Pack reloaded: \(loadedPack.manifest.packId)")
case .failure(let error):
    print("Reload failed, old pack preserved: \(error)")
}
```

#### ContentRegistry (Safe Reload)

```swift
// –ê—Ç–æ–º–∞—Ä–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å –æ—Ç–∫–∞—Ç–æ–º
let registry = ContentRegistry()
let result = registry.safeReloadPack(packId, from: url)
switch result {
case .success(let newPack):
    // –ù–æ–≤—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –∑–∞–≥—Ä—É–∂–µ–Ω
case .failure(let error):
    // –°—Ç–∞—Ä—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω
}
```

### –ü—Ä–∏–º–µ—Ä: –ë—ã—Å—Ç—Ä–∞—è –∏—Ç–µ—Ä–∞—Ü–∏—è

```bash
# –¢–µ—Ä–º–∏–Ω–∞–ª 1: –°–ª–µ–¥–∏–º –∑–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –∏ –ø–µ—Ä–µ–∫–æ–º–ø–∏–ª–∏—Ä—É–µ–º
cd Packages/TwilightEngine
fswatch -o ../StoryPacks/Season1/TwilightMarchesActI | \
    xargs -I{} swift run pack-compiler compile \
        ../StoryPacks/Season1/TwilightMarchesActI/Sources/.../TwilightMarchesActI \
        ~/Documents/Packs/TwilightMarchesActI.pack

# –í –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏: –Ω–∞–∂–∏–º–∞–µ–º Reload –≤ Content Manager
```

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **Bundled –ø–∞–∫–∏ –Ω–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è** ‚Äî –æ–Ω–∏ read-only –≤ –±–∞–Ω–¥–ª–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
2. **–ò–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞ —Ç—Ä–µ–±—É—é—Ç –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏** ‚Äî hot-reload —Ç–æ–ª—å–∫–æ –¥–ª—è –¥–∞–Ω–Ω—ã—Ö
3. **–ê–∫—Ç–∏–≤–Ω—ã–µ –∏–≥—Ä—ã** ‚Äî –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –∑–∞–ø—É—Å–∫–µ –∏–≥—Ä—ã, –Ω–µ –≤–æ –≤—Ä–µ–º—è –∞–∫—Ç–∏–≤–Ω–æ–π —Å–µ—Å—Å–∏–∏

### –û—Ç–ª–∞–¥–∫–∞ –ø—Ä–æ–±–ª–µ–º

#### –ü–∞–∫ –Ω–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ —Å–ø–∏—Å–∫–µ

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–∞–π–ª–∞: –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å `.pack`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—É—Ç—å: `Documents/Packs/`
3. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ Content Manager

#### –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç

1. –û—Ç–∫—Ä–æ–π—Ç–µ –¥–µ—Ç–∞–ª–∏ –ø–∞–∫–∞ –¥–ª—è —Å–ø–∏—Å–∫–∞ –æ—à–∏–±–æ–∫
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫—Ä–æ—Å—Å-—Å—Å—ã–ª–∫–∏ (hero ‚Üí cards, region ‚Üí neighbors)
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `pack-compiler validate` –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –æ—Ç—á—ë—Ç–∞

#### –ö–æ–Ω—Ç–µ–Ω—Ç –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è

1. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ Reload –ø—Ä–æ—à—ë–ª —É—Å–ø–µ—à–Ω–æ (–∑–µ–ª—ë–Ω—ã–π —Å—Ç–∞—Ç—É—Å)
2. –ù–∞—á–Ω–∏—Ç–µ –Ω–æ–≤—É—é –∏–≥—Ä—É (–∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫ –∞–∫—Ç–∏–≤–Ω–æ–π)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–µ—Ä—Å–∏—é –≤ manifest.json

---

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ PackEditor

–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç-–ø–∞–∫–æ–≤ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **PackEditor** ‚Äî macOS-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º.

PackEditor –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç:
- –í–∏–∑—É–∞–ª—å–Ω–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö 10 –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (–≤—Ä–∞–≥–∏, –∫–∞—Ä—Ç—ã, —Å–æ–±—ã—Ç–∏—è, —Ä–µ–≥–∏–æ–Ω—ã, –≥–µ—Ä–æ–∏, –∫–∞—Ä—Ç—ã —Å—É–¥—å–±—ã, –∫–≤–µ—Å—Ç—ã, –ø–æ–≤–µ–¥–µ–Ω–∏—è, —è–∫–æ—Ä—è, –±–∞–ª–∞–Ω—Å)
- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞ –ø–∞–∫–∞ (metadata, –≤–µ—Ä—Å–∏–∏, —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å)
- CRUD-–æ–ø–µ—Ä–∞—Ü–∏–∏ —Å —à–∞–±–ª–æ–Ω–∞–º–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è —Å—É—â–Ω–æ—Å—Ç–µ–π
- –ò–º–ø–æ—Ä—Ç/—ç–∫—Å–ø–æ—Ä—Ç —Å—É—â–Ω–æ—Å—Ç–µ–π —á–µ—Ä–µ–∑ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞
- –í–∞–ª–∏–¥–∞—Ü–∏—é –ø–∞–∫–∞ —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –æ—à–∏–±–æ–∫
- JSON-–ø—Ä–µ–≤—å—é –¥–ª—è –∫–∞–∂–¥–æ–π —Å—É—â–Ω–æ—Å—Ç–∏
- –ö–æ–º–ø–∏–ª—è—Ü–∏—é –≤ .pack –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç

–ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ: [PACK_EDITOR_GUIDE.md](./PACK_EDITOR_GUIDE.md) (RU) | [PACK_EDITOR_GUIDE_EN.md](./PACK_EDITOR_GUIDE_EN.md) (EN)

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –†—É—á–Ω–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ JSON (–æ–ø–∏—Å–∞–Ω–Ω–æ–µ –≤—ã—à–µ) –æ—Å—Ç–∞—ë—Ç—Å—è –∞–∫—Ç—É–∞–ª—å–Ω—ã–º –¥–ª—è CI/CD –ø–∞–π–ø–ª–∞–π–Ω–æ–≤ –∏ —Å–∫—Ä–∏–ø—Ç–æ–≤–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞.

---

## –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- [HEROES_MODULE.md](../Engine/Heroes/HEROES_MODULE.md) ‚Äî –ú–æ–¥—É–ª—å –≥–µ—Ä–æ–µ–≤
- [ENGINE_ARCHITECTURE.md](./ENGINE_ARCHITECTURE.md) ‚Äî –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–≤–∏–∂–∫–∞
- [TECHNICAL_DOCUMENTATION.md](./TECHNICAL_DOCUMENTATION.md) ‚Äî –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
