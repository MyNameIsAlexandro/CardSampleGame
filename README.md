# Twilight Marches / Сумрачные Пределы

Сюжетная карточная RPG-кампания в славянском тёмном фэнтези для iOS.

## Описание

**Сумрачные Пределы** — игра, где вы исследуете мир Яви, реагирующий на течение времени и ваши решения. Удерживайте вторжения Нави, влияйте на баланс трёх миров и продвигайтесь к устранению источника разлома.

**Player Fantasy:** Вы — Страж границы между мирами.

## Основные механики

### Три мира
- **Явь** — мир живых, основное игровое пространство
- **Навь** — мир мёртвых, источник вторжений
- **Правь** — мир богов и высших сил

### Система регионов
Каждый регион имеет состояние, которое деградирует со временем:

| Состояние | Описание | Риск |
|-----------|----------|------|
| **Stable** | Безопасный регион | Низкий |
| **Borderland** | Граница с Навью | Средний |
| **Breach** | Прорыв Нави | Высокий |

### Якоря (Anchors)
Священные места, удерживающие границу между мирами:
- Укрепление якоря стабилизирует регион
- Осквернение даёт силу, но ухудшает мир
- Разрушенный якорь = Breach

### Система давления (Pressure)
- **WorldTension** растёт каждые 3 дня по формуле: `+3 + (daysPassed / 10)`
- При 100% — Game Over
- Игрок может замедлять, но не отменять эскалацию

### Ресурсы
- **Gold** — основная валюта
- **Faith** — для укрепления якорей
- **Supplies** — для путешествий

## Core Loop

```
1. Состояние мира ухудшается (время / WorldTension)
           ↓
2. Игрок выбирает регион на карте
           ↓
3. Видит риск и возможные последствия
           ↓
4. Происходит событие (бой / выбор / исследование)
           ↓
5. Мир меняется (локально и/или глобально)
           ↓
6. Продвижение к квестам
           ↓
7. Новый день → возврат к шагу 1
```

**Ключевой принцип:** Каждое действие = день. Время — невосполнимый ресурс.

## Архитектура

### Engine (Processor + Cartridge)
Модульная архитектура переиспользуемого движка:

```
Engine/
├── Core/           # Ядро движка
│   ├── TwilightGameEngine.swift    # Главный движок
│   ├── TimeEngine.swift            # Управление временем
│   ├── PressureEngine.swift        # Система давления
│   └── EconomyManager.swift        # Экономика
├── Config/         # Конфигурация ("картридж")
├── Data/           # Data-driven контент
│   └── Definitions/  # JSON-совместимые определения
└── Adapters/       # Адаптеры для legacy кода
```

### ContentProvider
Data-driven подход к контенту:
- `TwilightMarchesCodeContentProvider` — "картридж" игры
- Регионы, якоря, события определяются через Definition-структуры
- Легко добавлять новый контент без изменения движка

### Документация
- `Docs/ENGINE_ARCHITECTURE.md` — архитектура движка (source of truth)
- `Docs/EXPLORATION_CORE_DESIGN.md` — дизайн системы исследования
- `Docs/TECHNICAL_DOCUMENTATION.md` — техническая документация
- `Docs/GAME_DESIGN_DOCUMENT.md` — игровой дизайн

## Требования

- iOS 16.0+
- Xcode 15.0+
- Swift 5.9+

## Установка

```bash
git clone https://github.com/MyNameIsAlexandro/CardSampleGame.git
cd CardSampleGame
open CardSampleGame.xcodeproj
```

Выберите симулятор и нажмите **Cmd+R**.

## Тестирование

Проект включает comprehensive test suite:

```bash
# Запуск всех тестов
xcodebuild test -scheme CardSampleGame -destination 'platform=iOS Simulator,name=iPhone 17 Pro'
```

### Категории тестов
- **EngineContractsTests** — контракты движка
- **DataSeparationTests** — data-driven архитектура
- **MetricsDistributionTests** — статистические тесты баланса
- **Phase3ContractTests** — контракты Phase 3

## Технологии

- SwiftUI
- Combine
- MVVM + Engine архитектура
- Data-driven design (JSON/Codable)
- Deterministic RNG для воспроизводимости

## Лицензия

MIT License

---

**Защитите границу миров!**
