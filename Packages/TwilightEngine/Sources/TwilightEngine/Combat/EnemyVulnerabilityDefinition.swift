/// Файл: Packages/TwilightEngine/Sources/TwilightEngine/Combat/EnemyVulnerabilityDefinition.swift
/// Назначение: Vulnerability/resistance modifiers for enemy type × action × zone.
/// Зона ответственности: Data model for per-enemy vulnerability/resistance definitions.
/// Контекст: Epic 22 — Systemic Asymmetry. INV-DC-035..037.

import Foundation

// MARK: - VulnerabilityModifier

/// Vulnerability/resistance modifier for a specific action type and zone.
/// Positive = vulnerability (increased damage), Negative = resistance.
public struct VulnerabilityModifier: Equatable, Codable, Sendable {
    public let actionType: DispositionActionType
    public let zone: ResonanceZone
    public let modifier: Int

    public init(actionType: DispositionActionType, zone: ResonanceZone, modifier: Int) {
        self.actionType = actionType
        self.zone = zone
        self.modifier = modifier
    }
}

// MARK: - EnemyVulnerabilityDefinition

/// Enemy vulnerability definition with per-zone overrides.
public struct EnemyVulnerabilityDefinition: Equatable, Codable, Sendable {
    public let enemyType: String
    public let modifiers: [VulnerabilityModifier]

    public init(enemyType: String, modifiers: [VulnerabilityModifier]) {
        self.enemyType = enemyType
        self.modifiers = modifiers
    }

    /// Lookup vulnerability modifier for given action and zone.
    /// Returns 0 if no specific modifier defined.
    public func modifier(for actionType: DispositionActionType, in zone: ResonanceZone) -> Int {
        modifiers.first { $0.actionType == actionType && $0.zone == zone }?.modifier ?? 0
    }
}
